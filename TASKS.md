# Tasks
## WIP

## Todo
- [ ] start implementing app
    - [ ] do a selection first
        - what are the options?
        - which one should i choose?

- [ ] consider plan control
    - premium plan for user space
    - logic should reside in user space service
    - documentate the difference
        - limit of media to upload (200?)
        - vide duration (30s -> 5min)
    - [ ] implement upload medium limit
        - consider the limit for basic and premium
        - update the plan document too
    - for all the end points that need it

## Pending
- [ ] prepare documents
    - terms of use
    - privacy policy
- [ ] add original_created_at column of medium
    - maybe read info from exif?
- [ ] contact form
    - on app to collect problems
- [ ] protect api endpoint from malicious access
    - rate limit. too many requests
    - request from outside of app
- [ ] datadog monitoring for api
    - will need to have a separate agent container, so not gonna do it for now
    - we can still check logs on cloudwatch
- [ ] implement timeline post detail page
- [ ] implement expire for jwt
- [ ] optimize memoria client docker image
    - multi stage build to pick only required files
    - standalone build
        - probably npm workspace is causing all the redundant files to be generated
- [ ] improve memoria api docker image
    - https://github.com/davidbyttow/govips/issues/394
    - should be at least built file with dynamically linked

## Done
- [x] try wegic for ui design
- [x] try galileo for ui design
- [x] try uizard for ui design
- [x] Service document
    - Document core concepts
    - What pain to solve by which feature
    - Roadmap
        - in which order I will be implementing?
    - what kind of feature would make it better app?
- [x] try to bounce ideas off of chat gpt
    - what kind of feature would make it better app?
- [x] implement transaction / rollback
- [x] introduce datadog for monitoring
- [x] perf improve
    - [x] album deletion
    - [x] add media to album
    - [x] remove media from album
- [x] logger for api
- [x] make media loading paginated
    - tap link on bottom to load more
    - update api
- [x] resource owner validation for any endpoints
- [x] make sure timestamp columns are recorded
- [x] dao impl refactoring
    - can we implement modelname method to pass around in basedao?
    - nope, golang does not allow method override, thus we cannot do this
- [x] make sure media gallery works okay
    - starting from middle to load previous page
    - starting from middle to load next page
- [x] improve bgjob performance
    - make it multiple go routines
    - make it buffered
- [x] implement toast system
    - use toast from react-spectrum
- [x] i18n
    - gotta do this bro
    - document title
- [x] make it pwa installable
- [x] try to DRY up handler test
    - create shared struct for the strcutre of test execution?
    - method for comparing structs?
    - can we make the failure log to show which test case failed?
- [x] implement timeline
    - [x] impl user space activity first
        - when user joined
        - when user upload media
    - [x] impl timeline post
        - [x] Create post
        - [x] create post with medium
        - [x] get timeline
            - implement with cursor pagination
    - [x] implement UI
- [x] sign up flow broken
    - after clicking signup confirm link, it gets redirected to lp
    - should redirected to signup-thanks
- [x] consider monetize
    - probably we can small start like ads based first, then premium plan
    - [x] document the monetization part
    - [x] research how can i introduce monetize
    - seems to be we should have more of the pages ready
    - let's come back to this once we implemented good chunk
- [x] work on albums feature
    - create doc for specs
    - album detail api
    - upload media api
        - whether link it to album or not
        - impl table part
        - consider adding name and extension for medium record
    - media list api
    - decide what to do with thumbnail
    - show upload status in drawer
    - restrict the media type to upload
    - try to introduce thumbnail to the media grid
        - can we make it like showing loader while loading and try error loading image?
    - support video
        - ios default
        - mp4
        - create thumbnails
    - delete media
    - delete album
    - link and unlink medium to album
    - when uploading media, optionally user can select album to add
    - medium detail page
    - write tests
        - [x] album add media
        - [x] album remove media
        - [x] medium find one
        - [x] medium get page
        - [x] medium confirm uploads
        - [x] medium delete
- [x] research lightsail
    - see if we can cut cost
- [x] refine the definition of service and usecase and dao
    - create documents
        - definition
        - architecture diagram
    - refactor based on it
    - should allow defning shortcut method (like find by id)
        - if not, the find option will be spreading the db detail (column name to be specified in findopt)
        - we cannot really prevent this entirely, but allowing shortcut method mitigates this problem
- [x] remove react-spectrum utility components
    - fix the problem with usesearchparams
    - do not use it
    - replace the tokens stuff as well
- [x] implement testing
    - consider how we do it
    - refactor codings
    - refactor struct namings
    - refactor scopebyfindoption to be Scope method based
    - refactor find methods
        - try to DRY it up little
- [x] make sure to replace secretkey for jwt to secure one through env var
- [x] improve form error handlings
    - signup
- [x] login feature
    - make sure to redirect to login page if user not authenticated
- [x] make sure db migration is run once
    - probably it is run twice in github action
- [x] textfield error icon overflow problem
    - when error is shown, the red triangle overflows
- [x] implement invite user
    - add the doc
- [x] implement logout
    - add the doc
    - implement in frontend
    - this is because persisting jwt is done in frontend, for consistency
- [x] implement login
    - add the doc
    - implement feedback part
- [x] implement validation system
    - allow api to return validation body
    - will be only one error (not returning multiple)
    - content will be
        - key
        - resource
        - property
        - value
    - impliment error feedback
        - toast or something
        - for bad request and internal server error
    - try panda css
        - if liked it:
            - say bye bye to tailwind
- [x] refactor
    - backend
    - move repository to interfaces/repository
    - move interface definition of ccontext to interfaces
- [x] cost optimization
    - use fargat spot
    - https://qiita.com/kurifumi/items/8480b415da65c4692c75
    - https://qiita.com/sugimount-a/items/1b64e1f2eb544e059371
- [x] implement email confirm flow in signup
    - update the doc
    - create ses for dev
    - create ses for prod
    - implement flow
    - implement guard for account status
- [x] create cicd pipeline to deploy automatically
- [x] build infrastructure
    - create vpc
    - create rds
    - deploy sample ecs
    - create next.js
    - create api
    - route 53
    - create bation server with ec2
    - create migration task
- [x] implement create account feature
    - [x] Implement Bottom navigation
    - [x] implement landing page
    - [x] api authentication
    - [x] app-data api
        - proceed with the content
    - [x] implement signup flow
        - impl sign up form
            - UI
            - form
            - logic
- [x] Ground work
    - [x] selection for design system
    - [x] List out use cases
    - [x] Create wireframe
    - [x] Create models doc

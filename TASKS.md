# Tasks
## WIP
- [ ] work on albums feature
    - create doc for specs
    - album detail api
    - upload media api
        - whether link it to album or not
        - impl table part
        - consider adding name and extension for medium record
    - media list api
    - decide what to do with thumbnail
    - show upload status in drawer
    - restrict the media type to upload
    - try to introduce thumbnail to the media grid
        - can we make it like showing loader while loading and try error loading image?
    - support video
        - ios default
        - mp4
        - create thumbnails
    - delete media
    - delete album
    - link and unlink medium to album
    - when uploading media, optionally user can select album to add
    - medium detail page
    - write tests

## Todo
- [ ] make sure media gallery works okay
    - starting from middle to load previous page
    - starting from middle to load next page
- [ ] try wegic for ui design
- [ ] improve memoria api docker image
    - https://github.com/davidbyttow/govips/issues/394
    - should be at least built file with dynamically linked
- [ ] apply pagination system to the list apis
- [ ] implement toast system
    - use toast from react-spectrum
- [ ] dao impl refactoring
    - can we implement modelname method to pass around in basedao?
- [ ] research how we can implement clickable element
    - what about div with button role?
- [ ] resource owner validation for data manipulative endpoints
- [ ] perf improve
    - album deletion
    - add media to album
    - remove media from album
- [ ] make media loading paginated
    - tap link on bottom to load more
    - update api
- [ ] consider plan control
    - premium plan for user space
    - logic should reside in user space service
    - documentate the difference
        - limit of media to upload (200?)
        - vide duration (30s -> 5min)
- [ ] improve error handling of upload media
    - when uploading fails
    - when user sends browser to background
- [ ] improve bgjob performance
    - make it multiple go routines
    - make it buffered
- [ ] try to DRY up handler test
    - create shared struct for the strcutre of test execution?
    - method for comparing structs?
    - can we make the failure log to show which test case failed?
- [ ] implement upload medium limit
- [ ] make sure timestamp columns are recorded
- [ ] research useButton props
    - learn and take note of how it helps
- [ ] take notes of why i thought i needed context boundary
    - was thinking of the case where:
        - Logic for uploading media could differ depending on context
            - in usespace based context, we need to validate the quantity for the day (how many they can upload per day)
            - in other context, above logic might not be needed
- [ ] implement transaction / rollback
    - for all the end points that need it
- [ ] optimize memoria client docker image
    - multi stage build to pick only required files
    - standalone build
- [ ] protect api endpoint from malicious access
    - too many requests
- [ ] implement expire for jwt
- [ ] make it pwa installable
- [ ] Refine meta data for each page
    - document title

## Done
- [x] research lightsail
    - see if we can cut cost
- [x] refine the definition of service and usecase and dao
    - create documents
        - definition
        - architecture diagram
    - refactor based on it
    - should allow defning shortcut method (like find by id)
        - if not, the find option will be spreading the db detail (column name to be specified in findopt)
        - we cannot really prevent this entirely, but allowing shortcut method mitigates this problem
- [x] remove react-spectrum utility components
    - fix the problem with usesearchparams
    - do not use it
    - replace the tokens stuff as well
- [x] implement testing
    - consider how we do it
    - refactor codings
    - refactor struct namings
    - refactor scopebyfindoption to be Scope method based
    - refactor find methods
        - try to DRY it up little
- [x] make sure to replace secretkey for jwt to secure one through env var
- [x] improve form error handlings
    - signup
- [x] login feature
    - make sure to redirect to login page if user not authenticated
- [x] make sure db migration is run once
    - probably it is run twice in github action
- [x] textfield error icon overflow problem
    - when error is shown, the red triangle overflows
- [x] implement invite user
    - add the doc
- [x] implement logout
    - add the doc
    - implement in frontend
    - this is because persisting jwt is done in frontend, for consistency
- [x] implement login
    - add the doc
    - implement feedback part
- [x] implement validation system
    - allow api to return validation body
    - will be only one error (not returning multiple)
    - content will be
        - key
        - resource
        - property
        - value
    - impliment error feedback
        - toast or something
        - for bad request and internal server error
    - try panda css
        - if liked it:
            - say bye bye to tailwind
- [x] refactor
    - backend
    - move repository to interfaces/repository
    - move interface definition of ccontext to interfaces
- [x] cost optimization
    - use fargat spot
    - https://qiita.com/kurifumi/items/8480b415da65c4692c75
    - https://qiita.com/sugimount-a/items/1b64e1f2eb544e059371
- [x] implement email confirm flow in signup
    - update the doc
    - create ses for dev
    - create ses for prod
    - implement flow
    - implement guard for account status
- [x] create cicd pipeline to deploy automatically
- [x] build infrastructure
    - create vpc
    - create rds
    - deploy sample ecs
    - create next.js
    - create api
    - route 53
    - create bation server with ec2
    - create migration task
- [x] implement create account feature
    - [x] Implement Bottom navigation
    - [x] implement landing page
    - [x] api authentication
    - [x] app-data api
        - proceed with the content
    - [x] implement signup flow
        - impl sign up form
            - UI
            - form
            - logic
- [x] Ground work
    - [x] selection for design system
    - [x] List out use cases
    - [x] Create wireframe
    - [x] Create models doc
